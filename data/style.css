*, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

:root {
    --bg: #1a1a2e;
    --surface: #16213e;
    --surface2: #0f3460;
    --text: #e0e0e0;
    --text-dim: #888;
    --correct: #0f9b58;
    --wrong: #e94560;
    --key-bg: #2a2a4a;
    --key-active: #3a3a6a;
}

html, body {
    height: 100dvh;
    overflow: hidden;
    touch-action: manipulation;
}

body {
    font-family: -apple-system, system-ui, sans-serif;
    background: var(--bg);
    color: var(--text);
    display: flex;
    flex-direction: column;
    border: 4px solid transparent;
    transition: border-color 0.1s;
}

/* Flash feedback */
body.flash-correct { border-color: var(--correct); }
body.flash-wrong { border-color: var(--wrong); }

/* Connection dot */
.conn-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: var(--wrong);
    flex-shrink: 0;
}
.conn-dot.connected { background: var(--correct); }

/* Landscape-only dot (top-right corner) */
#conn-dot {
    position: fixed;
    top: 8px;
    right: 8px;
    display: none;
    z-index: 10;
}

/* Settings panel */
#settings {
    padding: 8px 10px;
    background: var(--surface);
    flex-shrink: 0;
}

.settings-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
}
.settings-row:last-child { margin-bottom: 0; }

#profile-select {
    flex: 1;
    min-width: 0;
    background: var(--bg);
    color: var(--text);
    border: 1px solid var(--surface2);
    padding: 6px 8px;
    border-radius: 4px;
    font-size: 14px;
}

#speed-input {
    width: 52px;
    background: var(--bg);
    color: var(--text);
    border: 1px solid var(--surface2);
    padding: 6px 4px;
    border-radius: 4px;
    font-size: 14px;
    text-align: center;
}

#start-btn, #stop-btn {
    padding: 6px 16px;
    border: none;
    border-radius: 4px;
    font-size: 14px;
    cursor: pointer;
    color: #fff;
}
#start-btn { background: var(--surface2); }
#start-btn:active:not(:disabled) { background: #1a5276; }
#stop-btn { background: var(--wrong); }
#stop-btn:active:not(:disabled) { opacity: 0.8; }
#start-btn:disabled, #stop-btn:disabled { opacity: 0.35; cursor: default; }

#wpm-label {
    margin-left: auto;
    font-size: 14px;
    color: var(--text-dim);
    white-space: nowrap;
}

.slider-label {
    width: 40px;
    font-size: 14px;
    color: var(--text-dim);
    flex-shrink: 0;
}

#pitch-slider {
    flex: 1;
    min-width: 0;
    accent-color: var(--surface2);
}

.slider-value {
    width: 52px;
    font-size: 14px;
    color: var(--text-dim);
    text-align: right;
    flex-shrink: 0;
}

/* Keyboard */
#kb {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 6px;
    gap: 5px;
    min-height: 0;
}

.kb-row {
    display: flex;
    justify-content: center;
    gap: 4px;
}

/* QWERTY row offsets */
.kb-row:nth-child(2) { padding: 0 4%; }
.kb-row:nth-child(3) { padding: 0 10%; }

.key {
    flex: 1;
    max-width: 56px;
    min-height: 44px;
    height: clamp(44px, 8vh, 64px);
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--key-bg);
    color: var(--text);
    border: none;
    border-radius: 5px;
    font-size: clamp(14px, 3.5vw, 20px);
    font-weight: 600;
    cursor: pointer;
    user-select: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
}

.key:active, .key.active {
    background: var(--key-active);
}

/* Layer toggle key */
.key-toggle {
    max-width: 80px;
    flex: 1.5;
    font-size: clamp(12px, 3vw, 16px);
    background: var(--surface2);
}

/* Orientation: portrait — show settings, hide landscape dot */
@media (orientation: portrait) {
    #settings { display: block; }
    #conn-dot { display: none; }
}

/* Orientation: landscape — hide settings, show dot */
@media (orientation: landscape) {
    #settings { display: none; }
    #conn-dot { display: block; }
}
